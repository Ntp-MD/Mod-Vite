import y from"./Loading-CKrPoQ1U.js";import{f as i,o as W,g as I,w as b,c as u,a as l,b as A,v as L,n as c,F as B,h as G,i as N,e as r,t as d,j as M}from"./index-BYhDIkn4.js";import{a as F,P as O}from"./axios-ieKfxsDm.js";const T={key:0},x={class:"Tablefilter"},E={id:"search-form"},R=["onClick"],U={class:"TableViews"},z={__name:"OnlinePromotion",setup(V){const m=i(!0),h=i([]),s=i("All"),S=i(""),_=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],k="https://corsproxy.io/?"+encodeURIComponent("https://docs.google.com/spreadsheets/d/e/2PACX-1vRbhLBcw4jg80ogDxEeLs5wRrsQdFrWoN0g8OGy3aO_YJ0UoL-BIhuY8EozSzuTXppIIbfqp100FYIZ/pub?gid=1419480009&single=true&output=csv");W(async()=>{m.value=!0;try{const a=await F.get(k,{responseType:"text"});O.parse(a.data,{header:!0,complete:n=>{h.value=n.data.filter(t=>t.Name).map((t,e)=>({id:e+1,selectName:t.Name||"",selectfree5GB:t.Free5GB||"",selectfreeSearchConsole:t.FreeSearchConsole||"",selectfreeSmartWidget:t.FreeSmartWidget||"",onlineSearchConsole:t.OnlineSearchConsole||"",onlineSmartWidget:t.OnlineSmartWidget||"",Check5GB:t.Check5GB||"",onlineMonth:String(t.Month||"").trim()}))}})}catch{h.value=[]}finally{m.value=!1}});const p=I(()=>{let a=h.value;s.value!=="All"&&(a=a.filter(t=>t.onlineMonth===s.value));const n=S.value.toLowerCase();return n&&(a=a.filter(t=>t.selectName.toLowerCase().includes(n)||t.selectfree5GB.toLowerCase().includes(n)||t.selectfreeSearchConsole.toLowerCase().includes(n)||t.selectfreeSmartWidget.toLowerCase().includes(n))),a}),g=i(null);W(()=>{C()}),b(p,()=>{M(()=>C())});const C=()=>{g.value&&g.value.scrollIntoView({behavior:"smooth"})};return(a,n)=>{const t=y;return m.value?(r(),N(t,{key:1})):(r(),u("div",T,[l("div",x,[l("form",E,[A(l("input",{class:"search-input",type:"search",placeholder:"Search...","onUpdate:modelValue":n[0]||(n[0]=e=>S.value=e)},null,512),[[L,S.value]])]),l("button",{class:c({active:s.value==="All"}),onClick:n[1]||(n[1]=e=>s.value="All")},"All",2),(r(),u(B,null,G(_,(e,o)=>l("button",{key:o,class:c({active:s.value===String(o+1)}),onClick:f=>s.value=String(o+1)},d(e),11,R)),64))]),l("table",U,[n[2]||(n[2]=l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Upgrade 5GB"),l("th",null,"WIC Search Console"),l("th",null,"WIC Smart Widget")])],-1)),l("tbody",null,[(r(!0),u(B,null,G(p.value,(e,o)=>{var f,v;return r(),u("tr",{key:o},[l("td",null,d(e.selectName),1),l("td",{class:c({Installed:e.selectfree5GB==="เพิ่มพื้นที่ (5 GB)"&&e.Check5GB==="Completed",Wait:e.selectfree5GB==="เพิ่มพื้นที่ (5 GB)"&&e.Check5GB==="",NoService:e.selectfree5GB===""&&e.Check5GB===""})},d(!((f=e.selectfree5GB)!=null&&f.trim())&&!((v=e.Check5GB)!=null&&v.trim())?"ไม่มีบริการ":e.selectfree5GB),3),l("td",{class:c({Installed:e.onlineSearchConsole==="Installed",Wait:e.onlineSearchConsole==="Wait"||e.onlineSearchConsole===""||e.onlineSearchConsole==null})},d(e.onlineSearchConsole==="Wait"||e.onlineSearchConsole===""||e.onlineSearchConsole==null?"Search Console":e.onlineSearchConsole==="Installed"?"Search Console Installed":e.selectfreeSearchConsole),3),l("td",{class:c({Installed:e.onlineSmartWidget==="Installed"||e.selectfreeSmartWidget==="Smart Widget",Ads:e.onlineSmartWidget==="Google Ads",NoService:e.onlineSmartWidget==="ไม่มีบริการ",Wait:e.onlineSmartWidget==="Wait"})},d(e.onlineSmartWidget==="ไม่มีบริการ"?"ไม่มีบริการ":e.onlineSmartWidget==="Google Ads"?"Google Ads":e.onlineSmartWidget==="Wait"&&(e.selectfreeSmartWidget==="Smart Widget"||e.selectfreeSmartWidget==="")?"Smart Widget":e.onlineSmartWidget==="Installed"?"Smart Widget Installed":e.selectfreeSmartWidget),3)])}),128))])]),l("div",{ref_key:"bottom",ref:g},null,512)]))}}};export{z as default};
