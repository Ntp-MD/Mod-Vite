import S from"./Loading-l7HXSgq9.js";import{f as c,g as b,h as L,c as i,b as e,w as k,v as A,n as d,F as _,r as v,i as D,o as u,t as r}from"./index-CtpgwxJE.js";import{P as O}from"./papaparse.min-B654aPYJ.js";import{a as N}from"./axios-B2YOV0tR.js";const B={key:0},E={class:"Tablefilter"},M={id:"search-form"},R=["onClick"],T={class:"TableViews"},x=["href"],W={__name:"SheetOnline",setup(F){const m=c(!0),p=c([]),a=c("All"),h=c(""),g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],y="https://corsproxy.io/?"+encodeURIComponent("https://docs.google.com/spreadsheets/d/e/2PACX-1vRbhLBcw4jg80ogDxEeLs5wRrsQdFrWoN0g8OGy3aO_YJ0UoL-BIhuY8EozSzuTXppIIbfqp100FYIZ/pub?gid=1419480009&single=true&output=csv");b(async()=>{m.value=!0;try{const s=await N.get(y,{responseType:"text"});O.parse(s.data,{header:!0,complete:n=>{p.value=n.data.filter(t=>t.Name).map((t,l)=>({id:l+1,column1:t.Name||"",column2:t["Search Console"]||"",column3:t["Smart Widget"]||"",column4:t["Online Date"]||"",month:String(t.Month||"").trim()}))}})}catch{p.value=[]}finally{m.value=!1}});const C=L(()=>{let s=p.value;a.value!=="All"&&(s=s.filter(t=>t.month===a.value));const n=h.value.toLowerCase();return n&&(s=s.filter(t=>t.name.toLowerCase().includes(n)||t.searchConsole.toLowerCase().includes(n)||t.smartWidget.toLowerCase().includes(n)||t.onlineDate.toLowerCase().includes(n))),s});function f(s){return s?s.includes("Google Ads")?"status1":s.includes("ติดตั้งเรียบร้อย")?"status2":s.includes("รอดำเนินการ")?"status3":s.includes("ไม่มีบริการ")?"status4":"":""}return(s,n)=>{const t=S;return m.value?(u(),D(t,{key:1})):(u(),i("div",B,[e("div",E,[e("form",M,[k(e("input",{class:"search-input",type:"search",placeholder:"Search...","onUpdate:modelValue":n[0]||(n[0]=l=>h.value=l)},null,512),[[A,h.value]])]),e("button",{class:d({active:a.value==="All"}),onClick:n[1]||(n[1]=l=>a.value="All")},"All",2),(u(),i(_,null,v(g,(l,o)=>e("button",{key:o,class:d({active:a.value===String(o+1)}),onClick:I=>a.value=String(o+1)},r(l),11,R)),64))]),e("table",T,[n[2]||(n[2]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Search Console"),e("th",null,"Smart Widget"),e("th",null,"Online Date")])],-1)),e("tbody",null,[(u(!0),i(_,null,v(C.value,(l,o)=>(u(),i("tr",{key:o},[e("td",null,[e("a",{href:"http://"+l.name,target:"_blank"},r(l.column1),9,x)]),e("td",{class:d(f(l.column2))},r(l.column2),3),e("td",{class:d(f(l.column3))},r(l.column3),3),e("td",null,r(l.column4),1)]))),128))])])]))}}};export{W as default};
