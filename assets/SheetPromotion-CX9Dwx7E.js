import S from"./Loading-l7HXSgq9.js";import{f as a,g as k,h as m,c as d,b as o,w as A,v as b,F as C,r as L,i as M,o as r,t as p,n as y}from"./index-CtpgwxJE.js";import{P as x}from"./papaparse.min-B654aPYJ.js";import{a as B}from"./axios-B2YOV0tR.js";const E={key:0},V={class:"Tablefilter"},X={id:"search-form"},G={class:"TableViews"},O=["href"],N={__name:"SheetPromotion",setup(P){const u=a(!0),n=a([]),f=a("All"),h=a("All"),c=a(""),v="https://corsproxy.io/?"+encodeURIComponent("https://docs.google.com/spreadsheets/d/e/2PACX-1vSQhdMYSXXIfiuIfj7snoEY7kXjbMk0eXkIuYE1fApzW-1x0VeOlu3-3O7ruSOX6yV2JGlnaM68ltMa/pub?gid=1023775006&single=true&output=csv");k(async()=>{u.value=!0;try{const e=await B.get(v,{responseType:"text"});x.parse(e.data,{header:!0,complete:s=>{n.value=s.data.filter(t=>t.ชื่อเว็บไซต์).map((t,l)=>{const i=String(t.Month||"").trim(),[R,T]=i.split(" ");return{id:l+1,column1:t.ชื่อเว็บไซต์||"",column2:t.โปรโมชั่น||"",column3:t.Remark||""}})}})}catch{n.value=[]}finally{u.value=!1}}),m(()=>{const e=n.value.map(s=>s.month).filter(Boolean);return["All",...Array.from(new Set(e))]}),m(()=>{const e=n.value.map(s=>s.year).filter(Boolean);return["All",...Array.from(new Set(e))]});const g=m(()=>{let e=n.value;f.value!=="All"&&(e=e.filter(t=>t.month===f.value)),h.value!=="All"&&(e=e.filter(t=>t.year===h.value));const s=c.value.toLowerCase();return s&&(e=e.filter(t=>t.column1.toLowerCase().includes(s)||t.column2.toLowerCase().includes(s)||t.column3.toLowerCase().includes(s))),e});function _(e){return e?e.includes("เพิ่มพื้นที่ (5 GB)")?"status1":e.includes("Google Search Console")?"status2":e.includes("Smart Widget")?"status3":e.includes("ไม่มีบริการ")?"status4":"":""}return(e,s)=>{const t=S;return u.value?(r(),M(t,{key:1})):(r(),d("div",E,[o("div",V,[o("form",X,[A(o("input",{class:"search-input",type:"search",placeholder:"Search...","onUpdate:modelValue":s[0]||(s[0]=l=>c.value=l)},null,512),[[b,c.value]])])]),o("table",G,[s[1]||(s[1]=o("thead",null,[o("tr",null,[o("th",null,"Website"),o("th",null,"Promotion"),o("th",null,"Note")])],-1)),o("tbody",null,[(r(!0),d(C,null,L(g.value,(l,i)=>(r(),d("tr",{key:i},[o("td",null,[o("a",{href:"http://"+l.column1,target:"_blank"},p(l.column1),9,O)]),o("td",{class:y(_(l.column2))},p(l.column2),3),o("td",{class:y(_(l.column3))},p(l.column3),3)]))),128))])])]))}}};export{N as default};
