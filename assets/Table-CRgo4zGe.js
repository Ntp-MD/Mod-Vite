import{r as $,e as V,_ as ce,k as de,c as P,b as i,F as O,f as Y,u as s,l as fe,t as M,o as T,n as U,m as he}from"./index-BqmDkXNk.js";const E=$([]),L=$(1),H=$([]),j=$({}),x=$([]),p=$(0),v=$(0),k=$("idle"),C=$(0),G=$(5),J=5,o=$(6),me=$(1e3),B=$(0),g=$([]),h=$([]),r=$([]),A=$([]),X=$([]),Z=$([]),$e=$([]),y=$([]),be=[5,10,20,50,100,200],z=5,Q=V(()=>Math.max(0,C.value-(r.value[0]||0))),ge=V(()=>h.value[0]+(r.value[0]||0)),ke=V(()=>C.value===(r.value[0]||0)),ye=V(()=>C.value>(r.value[0]||0)&&h.value[0]>=C.value-(r.value[0]||0)),pe=V(()=>h.value[0]>C.value-(r.value[0]||0)),_e=V(()=>h.value[0]>0&&k.value!=="idle"&&k.value!=="showdown"),q=$(null);function f(e){E.value[L.value-1]||(E.value[L.value-1]=[]),E.value[L.value-1].push(e)}function ee(e){switch(e){case"♠":return"spades";case"♥":return"hearts";case"♦":return"diamonds";case"♣":return"clubs";default:return""}}function se(){const e=["♠","♥","♦","♣"],u=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],t=[];for(const l of e)for(const n of u)t.push({rank:n,suit:l});for(let l=t.length-1;l>0;l--){const n=Math.floor(Math.random()*(l+1));[t[l],t[n]]=[t[n],t[l]]}return t}function oe(e,u){const t={};for(let l=0;l<e;l++)t[l]=H.value.splice(0,u);return t}function re(e){const u={2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13,A:14},t={},l={},n=e.map(c=>u[c.rank]).sort((c,I)=>c-I);for(const c of e){const I=u[c.rank];t[I]=(t[I]||0)+1,l[c.suit]=(l[c.suit]||0)+1}const a=Object.values(l).some(c=>c>=5);let d=null;if(a){for(const c in l)if(l[c]>=5){d=c;break}}const _=(a?e.filter(c=>c.suit===d):e).map(c=>u[c.rank]).sort((c,I)=>c-I);let m=[...new Set(_)].sort((c,I)=>c-I),b=!1,w=0;if(m.length>=5){for(let c=m.length-1;c>=4;c--)if(m[c]-m[c-4]===4){b=!0,w=m[c];break}!b&&m.includes(14)&&m.includes(2)&&m.includes(3)&&m.includes(4)&&m.includes(5)&&(b=!0,w=5)}const N=Object.values(t).sort((c,I)=>I-c);let S=0,F="High Card";return a&&b&&w===14?(S=10,F="Royal Flush"):a&&b?(S=9,F="Straight Flush"):N[0]===4?(S=8,F="Four of a Kind"):N[0]===3&&N[1]>=2?(S=7,F="Full House"):a?(S=6,F="Flush"):b?(S=5,F="Straight"):N[0]===3?(S=4,F="Three of a Kind"):N[0]===2&&N[1]===2?(S=3,F="Two Pair"):N[0]===2&&(S=2,F="One Pair"),{handName:F,handRank:S,highCard:Math.max(...n),values:n}}function ie(){B.value=Math.floor(Math.random()*o.value);const e=["Dealer","SB","BB","UTG","MP","CO"];for(let u=0;u<o.value;u++){const t=(u-B.value+o.value)%o.value;Z.value[u]=e[t]||`P${u}`}}function Ae(e){for(let u=e.length-1;u>0;u--){const t=Math.floor(Math.random()*(u+1));[e[u],e[t]]=[e[t],e[u]]}return e}function ae(){E.value=[],L.value=1,H.value=se(),x.value=[],p.value=0,v.value=0,k.value="betting",C.value=0,$e.value=Ae([...Array(o.value).keys()]),g.value=Array.from({length:o.value},(n,a)=>a===0?"You":`AI ${a}`),j.value=oe(o.value,2),h.value=Array(o.value).fill(me.value),r.value=Array(o.value).fill(0),A.value=Array(o.value).fill(!1),X.value=Array(o.value).fill(""),y.value=Array(o.value).fill(!1),ie();const e=J*1,u=J*2,t=(B.value+1)%o.value,l=(B.value+2)%o.value;f(`--- Round ${L.value} ---`),h.value[t]-=e,r.value[t]=e,p.value+=e,f(`${g.value[t]} posts small blind: ${e}$`),h.value[l]-=u,r.value[l]=u,p.value+=u,f(`${g.value[l]} posts big blind: ${u}$`),C.value=u,v.value=(l+1)%o.value,D()}function le(){B.value=0,L.value=1,E.value=[],k.value="idle",g.value=[],h.value=[],r.value=[],A.value=[],X.value=[],Z.value=[],y.value=[],x.value=[],p.value=0,v.value=0,H.value=[],j.value={},G.value=z,f("Game reset. Configure settings and click 'Start Game' to begin.")}function te(){B.value=(B.value+1)%o.value,L.value++,E.value.push([]),H.value=se(),x.value=[],p.value=0,v.value=0,k.value="betting",C.value=0,j.value=oe(o.value,2),r.value=Array(o.value).fill(0),A.value=Array(o.value).fill(!1),X.value=Array(o.value).fill(""),y.value=Array(o.value).fill(!1),ie(),f(`--- Round ${L.value} ---`);const e=J,u=J*2;let t,l;o.value===2?(t=B.value,l=(B.value+1)%o.value):(t=(B.value+1)%o.value,l=(B.value+2)%o.value);const n=Math.min(e,h.value[t]+(r.value[t]||0));h.value[t]-=n,r.value[t]=(r.value[t]||0)+n,p.value+=n,f(`${g.value[t]} posts small blind: ${n}$`);const a=Math.min(u,h.value[l]+(r.value[l]||0));h.value[l]-=a,r.value[l]=(r.value[l]||0)+a,p.value+=a,f(`${g.value[l]} posts big blind: ${a}$`),C.value=r.value[l],v.value=(l+1)%o.value,D()}function ne(){if(y.value=Array(o.value).fill(!1),r.value=Array(o.value).fill(0),C.value=0,q.value=null,k.value==="betting")Ce(),f("--- Flop ---"),k.value="flop";else if(k.value==="flop")Me(),f("--- Turn ---"),k.value="turn";else if(k.value==="turn")Re(),f("--- River ---"),k.value="river";else if(k.value==="river")return k.value="showdown",ve(),!0;return v.value=0,!1}let W=!1;async function D(){if(!W){W=!0;try{for(;;){if(A.value.filter(e=>!e).length<=1){k.value="showdown",ve();return}if(v.value>=0&&v.value<o.value&&!A.value[v.value]&&!y.value[v.value])break;if(v.value=(v.value+1)%o.value,y.value.every((e,u)=>e||A.value[u])){ne()||setTimeout(D,500);return}}if(v.value===0)return;try{const e=Pe(v.value);await new Promise(u=>setTimeout(u,500)),Te(v.value,e)}catch(e){console.error(`Error during AI ${g.value[v.value]}'s turn:`,e),f(`Error for ${g.value[v.value]}. They are folded due to an error.`),v.value>=0&&v.value<o.value&&(A.value[v.value]=!0,y.value[v.value]=!0)}if(y.value.every((e,u)=>e||A.value[u])){ne()||setTimeout(D,500);return}v.value=(v.value+1)%o.value,setTimeout(D,200)}catch(e){console.error("Critical error in nextTurn game logic:",e),f("A critical error occurred. Game progression might be halted.")}finally{W=!1}}}function Ce(){x.value=H.value.splice(0,3),k.value="flop",y.value=Array(o.value).fill(!1)}function Me(){x.value.push(H.value.splice(0,1)[0]),k.value="turn",y.value=Array(o.value).fill(!1)}function Re(){x.value.push(H.value.splice(0,1)[0]),k.value="river",y.value=Array(o.value).fill(!1)}function K(e,u=0){if(v.value!==0)return;let t="";if(e==="fold")A.value[0]=!0,t="You folded.";else if(e==="check")t="You checked.";else if(e==="call"){const l=Q.value;h.value[0]-=l,r.value[0]+=l,p.value+=l,t=`You called $${l}`}else if(e==="raise"){const l=Q.value,n=Math.max(z,u),a=l+n;if(h.value[0]<a){t="Not enough money to raise.",f(t);return}h.value[0]-=a,r.value[0]+=a,p.value+=a,C.value=r.value[0],q.value=0,t=`You raised $${n} (to $${r.value[0]})`,y.value=y.value.map((d,R)=>!!(R===0||A.value[R]))}else if(e==="all-in"){const l=h.value[0];h.value[0]=0,r.value[0]+=l,p.value+=l,t=`You go ALL-IN with $${l} (total bet $${r.value[0]})`,r.value[0]>C.value&&(C.value=r.value[0],q.value=0,y.value=y.value.map((n,a)=>!!(a===0||A.value[a])),t+=", raising the bet!")}f(t),y.value[0]=!0,v.value=(v.value+1)%o.value,setTimeout(()=>D(),500)}function Pe(e){const u=r.value[e],t=C.value-u,l=h.value[e],n=p.value,a=Math.random()*.4+.6,d=j.value[e].concat(x.value),_=re(d).handRank;if(A.value[e])return{action:"fold"};if(l<t&&t>0){const b=_/10+n/(n+l)*.5;return l>0&&Math.random()<b?{action:"call"}:{action:"fold"}}const m=()=>{let b;_>=8?b=.7+Math.random()*.6:_>=5?b=.4+Math.random()*.4:_>=2?b=.3+Math.random()*.25:b=.25+Math.random()*.3;let w=n*b;return w*=1+(a-.5)*.5,Math.max(z,Math.round(w/5)*5)};if(_>=8)return t===0?Math.random()<.9+a*.1?{action:"raise",amount:m()}:{action:"check"}:Math.random()<.85+a*.15?{action:"raise",amount:m()}:{action:"call"};if(_>=5){if(t===0)return Math.random()<.7+a*.2?{action:"raise",amount:m()}:{action:"check"};if(t<=l*(.6+a*.15))return Math.random()<.65+a*.2?{action:"raise",amount:m()}:{action:"call"};if(t<=l*(.8+a*.1)){const b=Math.random();return b<.3+a*.1?{action:"raise",amount:m()}:b<.95+a*.05?{action:"call"}:{action:"fold"}}else return Math.random()<.5+a*.2?{action:"call"}:{action:"fold"}}else if(_>=2){if(t===0)return Math.random()<.45+a*.2?{action:"raise",amount:m()}:{action:"check"};if(t<=l*(.3+a*.1)){const b=Math.random();return b<.2+a*.15?{action:"raise",amount:m()}:b<.9+a*.1?{action:"call"}:{action:"fold"}}else return t<=l*(.7+a*.1)?Math.random()<.85+a*.15?{action:"call"}:{action:"fold"}:Math.random()<.4+a*.15?{action:"call"}:{action:"fold"}}else return t===0?Math.random()<.2+a*.5?{action:"raise",amount:m()}:{action:"check"}:t<=l*(.25+a*.1)&&t<n*.35?Math.random()<.55+a*.2?{action:"call"}:{action:"fold"}:t<=l*(.4+a*.15)&&Math.random()<.1+a*.15?{action:"call"}:{action:"fold"}}function Te(e,u){const{action:t,amount:l}=u,n=h.value[e],a=r.value[e]||0,d=C.value-a;if(t==="fold")A.value[e]=!0,f(`${g.value[e]} folds.`);else if(t==="raise"){const R=n-d;let _=Math.min(l,R);if(n>d+_&&(_=Math.max(z,_)),_<=0&&d===0)f(`${g.value[e]} checks.`);else if(_<0)A.value[e]=!0,f(`${g.value[e]} folds (unable to complete raise).`);else{const m=d+_;h.value[e]-=m,r.value[e]+=m,p.value+=m,C.value=r.value[e],q.value=e,h.value[e]===0&&m>0?f(`${g.value[e]} raises ALL-IN by $${_} (total bet $${r.value[e]})`):f(`${g.value[e]} raises by $${_} (total bet $${r.value[e]})`),y.value=y.value.map((b,w)=>A.value[w]||w===e)}}else if(t==="call")if(n>=d)h.value[e]-=d,r.value[e]+=d,p.value+=d,f(`${g.value[e]} calls $${d}`);else{const R=n;p.value+=R,r.value[e]+=R,h.value[e]=0,f(`${g.value[e]} calls ALL-IN with $${R}`)}else t==="check"&&(d>0?(A.value[e]=!0,f(`${g.value[e]} (AI) attempts to check facing a bet of $${d}, and folds.`)):f(`${g.value[e]} checks.`));y.value[e]=!0}function ve(){const e=[];for(let a=0;a<o.value;a++)if(!A.value[a]){const d=j.value[a].concat(x.value);e.push({index:a,handEvaluation:re(d)})}e.sort((a,d)=>d.handEvaluation.handRank-a.handEvaluation.handRank);const u=e.length>0?e[0].handEvaluation.handRank:-1,t=e.filter(a=>a.handEvaluation.handRank===u),l=t.length>0?Math.floor(p.value/t.length):0;t.forEach(a=>{h.value[a.index]+=l,f(`${g.value[a.index]} wins with ${a.handEvaluation.handName} and receives $${l}`)});const n=t.length>0?p.value%t.length:p.value;n>0&&t.length>0?(h.value[t[0].index]+=n,f(`${g.value[t[0].index]} receives an extra $${n} from remainder`)):n>0&&t.length===0&&e.length===1&&(h.value[e[0].index]+=n,f(`${g.value[e[0].index]} receives $${n} as the only remaining player.`)),p.value=0,f(`--- End of Round ${L.value} ---`)}function ue(e){G.value=Math.min(ge.value,G.value+e)}function Be(e){G.value=Math.max(z,G.value-e)}const xe={class:"TableLayout"},Se={class:"PlayerLineup"},Fe={class:"PlayerName"},Ie={class:"PlayerPos"},we={class:"PlayerPosition"},Le={class:"PlayerHand"},Ee={class:"RankCard"},Ne={class:"SuitCard"},Ge={class:"PlayerBet"},He={class:"TableFlob"},Oe={key:0,class:"TableFlobCard"},Ye={class:"RankCard"},De={class:"SuitCard"},Ve={class:"PoolMoney"},je={class:"PlayerAction"},Ke={class:"ActionButton"},ze=["disabled"],Je=["disabled"],Qe=["disabled"],qe=["disabled"],Ue={class:"ChipButton"},We=["onClick"],Xe=["onClick"],Ze=["onClick"],ea={class:"TableSetting"},aa=["disabled"],la={__name:"Table",setup(e){const u=$(null);return de(E,()=>{he(()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)})},{deep:!0}),(t,l)=>(T(),P("div",xe,[i("div",Se,[(T(!0),P(O,null,Y(s(g),(n,a)=>(T(),P("div",{key:a,class:U(["PlayerFrame",{activePlayers:a===s(v),foldedPlayers:s(A)[a],Main:a===0&&a===s(v),Player:a!==0&&a===s(v)}])},[i("div",Fe,[i("div",null,M(n),1),i("div",Ie,"("+M(s(Z)[a])+")",1)]),i("div",we,[i("div",null,"$"+M(s(h)[a]),1)]),i("div",Le,[(T(!0),P(O,null,Y(s(j)[a],(d,R)=>(T(),P("div",{key:R,class:U(["CardBody",s(ee)(d.suit)])},[i("div",Ee,M(d.rank),1),i("div",Ne,M(d.suit),1)],2))),128))]),i("div",Ge,"Bet: $"+M(s(r)[a]),1)],2))),128))]),i("div",He,[s(x)&&s(x).length?(T(),P("div",Oe,[(T(!0),P(O,null,Y(s(x),(n,a)=>(T(),P("div",{key:a,class:U(["CardBody",s(ee)(n.suit)])},[i("div",Ye,M(n.rank),1),i("div",De,M(n.suit),1)],2))),128))])):fe("",!0),i("div",Ve,M(s(p))+"$",1),i("div",null,"Current Game Phase: "+M(s(k)),1)]),i("div",{class:"TimelineLog",ref_key:"timelineLogRef",ref:u},[(T(!0),P(O,null,Y(s(E),(n,a)=>(T(),P("div",{key:a,class:"RoundLog"},[i("div",null,"Round "+M(a+1),1),i("div",null,[(T(!0),P(O,null,Y(n,(d,R)=>(T(),P("div",{key:R},M(d),1))),128))])]))),128))],512),i("div",je,[i("div",Ke,[i("button",{disabled:!s(ke),onClick:l[0]||(l[0]=n=>s(K)("check"))},"Check",8,ze),i("button",{disabled:!s(ye),onClick:l[1]||(l[1]=n=>s(K)("call",s(Q)))},M(`Call $${s(Q)}`),9,Je),i("button",{disabled:!s(pe),onClick:l[2]||(l[2]=n=>s(K)("raise",s(G)))},"Raise $"+M(s(G)),9,Qe),i("button",{disabled:!s(_e),onClick:l[3]||(l[3]=n=>s(K)("all-in"))},"All-In",8,qe),i("button",{onClick:l[4]||(l[4]=n=>s(K)("fold"))},"Fold")])]),i("div",Ue,[(T(!0),P(O,null,Y(s(be),n=>(T(),P("div",{key:n,class:"ChipBtn"},[i("button",{onClick:a=>s(Be)(n)},"-",8,We),i("button",{onClick:a=>s(ue)(n)},"$"+M(n),9,Xe),i("button",{onClick:a=>s(ue)(n)},"+",8,Ze)]))),128))]),i("div",ea,[i("button",{onClick:l[5]||(l[5]=(...n)=>s(ae)&&s(ae)(...n)),disabled:s(k)!=="idle"},"Start Game",8,aa),i("button",{onClick:l[6]||(l[6]=(...n)=>s(te)&&s(te)(...n))},"Next"),i("button",{onClick:l[7]||(l[7]=(...n)=>s(le)&&s(le)(...n))},"Reset")])]))}},na=ce(la,[["__scopeId","data-v-a2de944b"]]);export{na as default};
