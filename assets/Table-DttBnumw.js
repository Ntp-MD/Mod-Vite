import{r as $,e as V,_ as ce,a as R,b as r,F as O,g as Y,u as s,q as de,t as M,o as P,n as U}from"./index-CNtdOC62.js";const N=$([]),E=$(1),H=$([]),j=$({}),S=$([]),p=$(0),v=$(0),k=$("idle"),C=$(0),G=$(5),z=5,o=$(6),fe=$(1e3),T=$(0),b=$([]),f=$([]),i=$([]),A=$([]),X=$([]),Z=$([]),he=$([]),y=$([]),me=[5,10,20,50,100,200],q=5,J=V(()=>Math.max(0,C.value-(i.value[0]||0))),$e=V(()=>f.value[0]+(i.value[0]||0)),be=V(()=>C.value===(i.value[0]||0)),ge=V(()=>C.value>(i.value[0]||0)&&f.value[0]>=C.value-(i.value[0]||0)),ke=V(()=>f.value[0]>C.value-(i.value[0]||0)),ye=V(()=>f.value[0]>0&&k.value!=="idle"&&k.value!=="showdown"),Q=$(null);function d(e){N.value[E.value-1]||(N.value[E.value-1]=[]),N.value[E.value-1].push(e)}function ee(e){switch(e){case"♠":return"spades";case"♥":return"hearts";case"♦":return"diamonds";case"♣":return"clubs";default:return""}}function se(){const e=["♠","♥","♦","♣"],u=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],a=[];for(const l of e)for(const n of u)a.push({rank:n,suit:l});for(let l=a.length-1;l>0;l--){const n=Math.floor(Math.random()*(l+1));[a[l],a[n]]=[a[n],a[l]]}return a}function oe(e,u){const a={};for(let l=0;l<e;l++)a[l]=H.value.splice(0,u);return a}function ie(e){const u={2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13,A:14},a={},l={},n=e.map(c=>u[c.rank]).sort((c,I)=>c-I);for(const c of e){const I=u[c.rank];a[I]=(a[I]||0)+1,l[c.suit]=(l[c.suit]||0)+1}const t=Object.values(l).some(c=>c>=5);let h=null;if(t){for(const c in l)if(l[c]>=5){h=c;break}}const _=(t?e.filter(c=>c.suit===h):e).map(c=>u[c.rank]).sort((c,I)=>c-I);let m=[...new Set(_)].sort((c,I)=>c-I),g=!1,w=0;if(m.length>=5){for(let c=m.length-1;c>=4;c--)if(m[c]-m[c-4]===4){g=!0,w=m[c];break}!g&&m.includes(14)&&m.includes(2)&&m.includes(3)&&m.includes(4)&&m.includes(5)&&(g=!0,w=5)}const L=Object.values(a).sort((c,I)=>I-c);let B=0,F="High Card";return t&&g&&w===14?(B=10,F="Royal Flush"):t&&g?(B=9,F="Straight Flush"):L[0]===4?(B=8,F="Four of a Kind"):L[0]===3&&L[1]>=2?(B=7,F="Full House"):t?(B=6,F="Flush"):g?(B=5,F="Straight"):L[0]===3?(B=4,F="Three of a Kind"):L[0]===2&&L[1]===2?(B=3,F="Two Pair"):L[0]===2&&(B=2,F="One Pair"),{handName:F,handRank:B,highCard:Math.max(...n),values:n}}function re(){T.value=Math.floor(Math.random()*o.value);const e=["Dealer","SB","BB","UTG","MP","CO"];for(let u=0;u<o.value;u++){const a=(u-T.value+o.value)%o.value;Z.value[u]=e[a]||`P${u}`}}function pe(e){for(let u=e.length-1;u>0;u--){const a=Math.floor(Math.random()*(u+1));[e[u],e[a]]=[e[a],e[u]]}return e}function ae(){N.value=[],E.value=1,H.value=se(),S.value=[],p.value=0,v.value=0,k.value="betting",C.value=0,he.value=pe([...Array(o.value).keys()]),b.value=Array.from({length:o.value},(n,t)=>t===0?"You":`AI ${t}`),j.value=oe(o.value,2),f.value=Array(o.value).fill(fe.value),i.value=Array(o.value).fill(0),A.value=Array(o.value).fill(!1),X.value=Array(o.value).fill(""),y.value=Array(o.value).fill(!1),re();const e=z*1,u=z*2,a=(T.value+1)%o.value,l=(T.value+2)%o.value;d(`--- Round ${E.value} ---`),f.value[a]-=e,i.value[a]=e,p.value+=e,d(`${b.value[a]} posts small blind: ${e}$`),f.value[l]-=u,i.value[l]=u,p.value+=u,d(`${b.value[l]} posts big blind: ${u}$`),C.value=u,v.value=(l+1)%o.value,D()}function le(){T.value=0,E.value=1,N.value=[],k.value="idle",b.value=[],f.value=[],i.value=[],A.value=[],X.value=[],Z.value=[],y.value=[],S.value=[],p.value=0,v.value=0,H.value=[],j.value={},G.value=q,d("Game reset. Configure settings and click 'Start Game' to begin.")}function te(){T.value=(T.value+1)%o.value,E.value++,N.value.push([]),H.value=se(),S.value=[],p.value=0,v.value=0,k.value="betting",C.value=0,j.value=oe(o.value,2),i.value=Array(o.value).fill(0),A.value=Array(o.value).fill(!1),X.value=Array(o.value).fill(""),y.value=Array(o.value).fill(!1),re(),d(`--- Round ${E.value} ---`);const e=z,u=z*2;let a,l;o.value===2?(a=T.value,l=(T.value+1)%o.value):(a=(T.value+1)%o.value,l=(T.value+2)%o.value);const n=Math.min(e,f.value[a]+(i.value[a]||0));f.value[a]-=n,i.value[a]=(i.value[a]||0)+n,p.value+=n,d(`${b.value[a]} posts small blind: ${n}$`);const t=Math.min(u,f.value[l]+(i.value[l]||0));f.value[l]-=t,i.value[l]=(i.value[l]||0)+t,p.value+=t,d(`${b.value[l]} posts big blind: ${t}$`),C.value=i.value[l],v.value=(l+1)%o.value,D()}function ne(){if(y.value=Array(o.value).fill(!1),i.value=Array(o.value).fill(0),C.value=0,Q.value=null,k.value==="betting")_e(),d("--- Flop ---"),k.value="flop";else if(k.value==="flop")Ae(),d("--- Turn ---"),k.value="turn";else if(k.value==="turn")Ce(),d("--- River ---"),k.value="river";else if(k.value==="river")return k.value="showdown",ve(),!0;return v.value=0,!1}let W=!1;async function D(){if(!W){W=!0;try{for(;;){if(A.value.filter(e=>!e).length<=1){k.value="showdown",ve();return}if(v.value>=0&&v.value<o.value&&!A.value[v.value]&&!y.value[v.value])break;if(v.value=(v.value+1)%o.value,y.value.every((e,u)=>e||A.value[u])){ne()||setTimeout(D,500);return}}if(v.value===0)return;try{const e=Me(v.value);await new Promise(u=>setTimeout(u,500)),Re(v.value,e)}catch(e){console.error(`Error during AI ${b.value[v.value]}'s turn:`,e),d(`Error for ${b.value[v.value]}. They are folded due to an error.`),v.value>=0&&v.value<o.value&&(A.value[v.value]=!0,y.value[v.value]=!0)}if(y.value.every((e,u)=>e||A.value[u])){ne()||setTimeout(D,500);return}v.value=(v.value+1)%o.value,setTimeout(D,200)}catch(e){console.error("Critical error in nextTurn game logic:",e),d("A critical error occurred. Game progression might be halted.")}finally{W=!1}}}function _e(){S.value=H.value.splice(0,3),k.value="flop",y.value=Array(o.value).fill(!1)}function Ae(){S.value.push(H.value.splice(0,1)[0]),k.value="turn",y.value=Array(o.value).fill(!1)}function Ce(){S.value.push(H.value.splice(0,1)[0]),k.value="river",y.value=Array(o.value).fill(!1)}function K(e,u=0){if(v.value!==0)return;let a="";if(e==="fold")A.value[0]=!0,a="You folded.";else if(e==="check")a="You checked.";else if(e==="call"){const l=J.value;f.value[0]-=l,i.value[0]+=l,p.value+=l,a=`You called $${l}`}else if(e==="raise"){const l=J.value,n=Math.max(q,u),t=l+n;if(f.value[0]<t){a="Not enough money to raise.",d(a);return}f.value[0]-=t,i.value[0]+=t,p.value+=t,C.value=i.value[0],Q.value=0,a=`You raised $${n} (to $${i.value[0]})`,y.value=y.value.map((h,x)=>x===0||A.value[x])}else if(e==="all-in"){const l=f.value[0];f.value[0]=0,i.value[0]+=l,p.value+=l,a=`You go ALL-IN with $${l} (total bet $${i.value[0]})`,i.value[0]>C.value&&(C.value=i.value[0],Q.value=0,y.value=y.value.map((n,t)=>t===0||A.value[t]),a+=", raising the bet!")}d(a),y.value[0]=!0,v.value=(v.value+1)%o.value,setTimeout(()=>D(),500)}function Me(e){const u=i.value[e],a=C.value-u,l=f.value[e],n=p.value,t=Math.random()*.4+.35,h=j.value[e].concat(S.value),_=ie(h).handRank;if(A.value[e])return{action:"fold"};if(l<a&&a>0){const g=_/10+n/(n+l)*.5;return l>0&&Math.random()<g?{action:"call"}:{action:"fold"}}const m=()=>{let g;_>=8?g=.7+Math.random()*.6:_>=5?g=.4+Math.random()*.4:_>=2&&(g=.25+Math.random()*.3);let w=n*g;const B=1+(t-.55)*.5;return w*=B,Math.max(q,Math.round(w/5)*5)};if(_>=8)return a===0?Math.random()<.9+t*.1?{action:"raise",amount:m()}:{action:"check"}:Math.random()<.85+t*.15?{action:"raise",amount:m()}:{action:"call"};if(_>=5){if(a===0)return Math.random()<.7+t*.2?{action:"raise",amount:m()}:{action:"check"};if(a<=l*(.6+t*.15))return Math.random()<.65+t*.2?{action:"raise",amount:m()}:{action:"call"};if(a<=l*(.8+t*.1)){const g=Math.random();return g<.3+t*.1?{action:"raise",amount:m()}:g<.95+t*.05?{action:"call"}:{action:"fold"}}else return Math.random()<.5+t*.2?{action:"call"}:{action:"fold"}}else if(_>=2){if(a===0)return Math.random()<.45+t*.2?{action:"raise",amount:m()}:{action:"check"};if(a<=l*(.3+t*.1)){const g=Math.random();return g<.2+t*.15?{action:"raise",amount:m()}:g<.9+t*.1?{action:"call"}:{action:"fold"}}else return a<=l*(.7+t*.1)?Math.random()<.85+t*.15?{action:"call"}:{action:"fold"}:Math.random()<.4+t*.15?{action:"call"}:{action:"fold"}}else return a===0?Math.random()<.2+t*.15?{action:"raise",amount:m()}:{action:"check"}:a<=l*(.25+t*.1)&&a<n*.35?Math.random()<.55+t*.2?{action:"call"}:{action:"fold"}:a<=l*(.4+t*.15)&&Math.random()<.1+t*.15?{action:"call"}:{action:"fold"}}function Re(e,u){const{action:a,amount:l}=u,n=f.value[e],t=i.value[e]||0,h=C.value-t;if(a==="fold")A.value[e]=!0,d(`${b.value[e]} folds.`);else if(a==="raise"){const x=n-h;let _=Math.min(l,x);if(n>h+_&&(_=Math.max(q,_)),_<=0&&h===0)d(`${b.value[e]} checks.`);else if(_<0)A.value[e]=!0,d(`${b.value[e]} folds (unable to complete raise).`);else{const m=h+_;f.value[e]-=m,i.value[e]+=m,p.value+=m,C.value=i.value[e],Q.value=e,f.value[e]===0&&m>0?d(`${b.value[e]} raises ALL-IN by $${_} (total bet $${i.value[e]})`):d(`${b.value[e]} raises by $${_} (total bet $${i.value[e]})`),y.value=y.value.map((g,w)=>A.value[w]||w===e)}}else if(a==="call")if(n>=h)f.value[e]-=h,i.value[e]+=h,p.value+=h,d(`${b.value[e]} calls $${h}`);else{const x=n;p.value+=x,i.value[e]+=x,f.value[e]=0,d(`${b.value[e]} calls ALL-IN with $${x}`)}else a==="check"&&(h>0?(A.value[e]=!0,d(`${b.value[e]} (AI) attempts to check facing a bet of $${h}, and folds.`)):d(`${b.value[e]} checks.`));y.value[e]=!0}function ve(){const e=[];for(let t=0;t<o.value;t++)if(!A.value[t]){const h=j.value[t].concat(S.value);e.push({index:t,handEvaluation:ie(h)})}e.sort((t,h)=>h.handEvaluation.handRank-t.handEvaluation.handRank);const u=e.length>0?e[0].handEvaluation.handRank:-1,a=e.filter(t=>t.handEvaluation.handRank===u),l=a.length>0?Math.floor(p.value/a.length):0;a.forEach(t=>{f.value[t.index]+=l,d(`${b.value[t.index]} wins with ${t.handEvaluation.handName} and receives $${l}`)});const n=a.length>0?p.value%a.length:p.value;n>0&&a.length>0?(f.value[a[0].index]+=n,d(`${b.value[a[0].index]} receives an extra $${n} from remainder`)):n>0&&a.length===0&&e.length===1&&(f.value[e[0].index]+=n,d(`${b.value[e[0].index]} receives $${n} as the only remaining player.`)),p.value=0,d(`--- End of Round ${E.value} ---`)}function ue(e){G.value=Math.min($e.value,G.value+e)}function Pe(e){G.value=Math.max(q,G.value-e)}const Be={class:"TableLayout"},Te={class:"PlayerLineup"},Se={class:"PlayerName"},xe={class:"PlayerPos"},Fe={class:"PlayerPosition"},Ie={class:"PlayerHand"},we={class:"RankCard"},Ee={class:"SuitCard"},Le={class:"PlayerBet"},Ne={class:"TableBoard"},Ge={class:"TimelineLog"},He={class:"PlayerAction"},Oe={class:"TableFlob"},Ye={key:0,class:"TableFlobCard"},De={class:"RankCard"},Ve={class:"SuitCard"},je={class:"PoolMoney"},Ke={class:"ActionButton"},qe=["disabled"],ze=["disabled"],Je=["disabled"],Qe=["disabled"],Ue={class:"ChipButton"},We=["onClick"],Xe=["onClick"],Ze=["onClick"],ea={class:"TableSetting"},aa=["disabled"],la={__name:"Table",setup(e){return(u,a)=>(P(),R("div",Be,[r("div",Te,[(P(!0),R(O,null,Y(s(b),(l,n)=>(P(),R("div",{key:n,class:U(["PlayerFrame",{activePlayers:n===s(v),foldedPlayers:s(A)[n],Main:n===0&&n===s(v),Player:n!==0&&n===s(v)}])},[r("div",Se,[r("div",null,M(l),1),r("div",xe,"("+M(s(Z)[n])+")",1)]),r("div",Fe,[r("div",null,"$"+M(s(f)[n]),1)]),r("div",Ie,[(P(!0),R(O,null,Y(s(j)[n],(t,h)=>(P(),R("div",{key:h,class:U(["CardBody",s(ee)(t.suit)])},[r("div",we,M(t.rank),1),r("div",Ee,M(t.suit),1)],2))),128))]),r("div",Le,"Bet: $"+M(s(i)[n]),1)],2))),128))]),r("div",Ne,[r("div",Ge,[(P(!0),R(O,null,Y(s(N),(l,n)=>(P(),R("div",{key:n,class:"RoundLog"},[r("div",null,"Round "+M(n+1),1),r("div",null,[(P(!0),R(O,null,Y(l,(t,h)=>(P(),R("div",{key:h},M(t),1))),128))])]))),128))]),r("div",He,[r("div",Oe,[s(S)&&s(S).length?(P(),R("div",Ye,[(P(!0),R(O,null,Y(s(S),(l,n)=>(P(),R("div",{key:n,class:U(["CardBody",s(ee)(l.suit)])},[r("div",De,M(l.rank),1),r("div",Ve,M(l.suit),1)],2))),128))])):de("",!0),r("div",je,M(s(p))+"$",1),r("div",null,"Current Game Phase: "+M(s(k)),1)]),r("div",Ke,[r("button",{disabled:!s(be),onClick:a[0]||(a[0]=l=>s(K)("check"))},"Check",8,qe),r("button",{disabled:!s(ge),onClick:a[1]||(a[1]=l=>s(K)("call",s(J)))},M(`Call $${s(J)}`),9,ze),r("button",{disabled:!s(ke),onClick:a[2]||(a[2]=l=>s(K)("raise",s(G)))},"Raise $"+M(s(G)),9,Je),r("button",{disabled:!s(ye),onClick:a[3]||(a[3]=l=>s(K)("all-in"))},"All-In",8,Qe),r("button",{onClick:a[4]||(a[4]=l=>s(K)("fold"))},"Fold")]),r("div",Ue,[(P(!0),R(O,null,Y(s(me),l=>(P(),R("div",{key:l,class:"ChipBtn"},[r("button",{onClick:n=>s(Pe)(l)},"-",8,We),r("button",{onClick:n=>s(ue)(l)},"$"+M(l),9,Xe),r("button",{onClick:n=>s(ue)(l)},"+",8,Ze)]))),128))]),r("div",ea,[r("button",{onClick:a[5]||(a[5]=(...l)=>s(ae)&&s(ae)(...l)),disabled:s(k)!=="idle"},"Start Game",8,aa),r("button",{onClick:a[6]||(a[6]=(...l)=>s(te)&&s(te)(...l))},"Next Round"),r("button",{onClick:a[7]||(a[7]=(...l)=>s(le)&&s(le)(...l))},"Reset")])])])]))}},na=ce(la,[["__scopeId","data-v-7b30182f"]]);export{na as default};
